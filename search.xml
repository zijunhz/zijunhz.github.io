<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title>A Number Guessing Game Bot</title>
    <url>/2022/04/28/A-Number-Guessing-Game-Bot/</url>
    <content><![CDATA[<p><div id="guessing_game">
    <h1>A Guessing Game</h1>
    <a target="_blank" href="https://baike.baidu.com/item/%E7%8C%9C%E6%95%B0%E5%AD%97/83200?fr=aladdin">Here's the
      rules.</a><br>
    <button onclick="init()">Start the Game</button><button onclick="result()">Correct!</button><br>
    <input id="reA" type="tel">A <input id="reB" type="tel">B<br>
    <button onclick="kill()">Confirm</button>
    <p id="inf"></p>
  </div><br>  <img scr="../images/avatar.png"></p>
<script>
let rule_on_show = 0, init1 = 0, tern = 0, ans, first = 1, tot = 0, pre = 0, l = 0, check = 0, G = 0, isright = 0, lA = 0;
let a = new Array(), b = new Array(), cmp = new Array(), rd = new Array();
function build() {
  for (let i = 0; i <= 5; i++)cmp[i] = new Array();
  for (let i = 0; i <= 9; i++)for (let j = 0; j <= 9; j++)for (let k = 0; k <= 9; k++)for (let l = 0; l <= 9; l++) {
    if (i == j || i == k || i == l || j == k || j == l || k == l) continue;
    a[++tot] = i * 1000 + j * 100 + k * 10 + l;
  }
}
function init() {
  document.getElementById("inf").innerHTML = '';
  if (first == 1) {
    build(); first = 0;
  }
  for (let i = 1; i <= tot; i++)b[i] = 1;
  check = 1; init1 = 1; tern = 0; isright = 0; lA = 0;
  makeguess();
}
function getn(x, n) {
  for (let i = 1; i <= 4 - n; i++)x = Math.floor(x / 10);
  return x % 10;
}
function compA(X, Y) {
  let x = new Array(), y = new Array(), A = 0;
  for (let i = 1; i <= 4; i++)x[i] = getn(X, i);
  for (let i = 1; i <= 4; i++)y[i] = getn(Y, i);
  for (let i = 1; i <= 4; i++)if (x[i] == y[i]) A++;
  return A;
}
function compB(X, Y) {
  let x = new Array(), y = new Array(), B = 0;
  for (let i = 1; i <= 4; i++)x[i] = getn(X, i);
  for (let i = 1; i <= 4; i++)y[i] = getn(Y, i);
  for (let i = 1; i <= 4; i++)for (let j = 1; j <= 4; j++)if (i != j && x[i] == y[j]) B++;
  return B;
}
function sqr(x) {
  return x * x;
}
function abS(x) {
  if (x >= 0) return x; return -x;
}
function makeguess() {
  tern++;
  if (tern == 1) {
    G = a[Math.ceil(Math.random() * Math.random() * tot * tot * tot) % tot + 1]; pre = 5040;
  } else {
    let bestans = 0, ans; l = 0, eps = 1e-3;
    pre = 0;
    for (let i = 1; i <= tot; i++) {
      pre += b[i]
    }
    for (let i = 1; i <= tot; i++) {
      if (b[i] == 0) continue;
      for (let j = 0; j <= 4; j++)for (let k = 0; k <= 4 - j; k++)cmp[j][k] = 0;
      for (let j = 1; j <= tot; j++)
        if (b[j] == 1) {
          cmp[compA(a[j], a[i])][compB(a[j], a[i])]++;
        }
      ans = 0;
      for (let j = 0; j <= 4; j++)for (let k = 0; k <= 4 - j; k++)
        if (cmp[j][k] != 0) {
          ans += Math.log(pre / cmp[j][k]) * cmp[j][k] / pre;//sqr(ave-cmp[j][k]);
        }
      //ans/=cnt;ans-=cnt*1.1;
      if (abS(ans - bestans) <= eps) {
        rd[++l] = i;
        console.log(ans + ' ' + a[rd[l]]);
        continue;
      }
      if (ans > bestans) {
        console.log(ans + ' ' + a[rd[1]])
        l = 1; rd[1] = i; bestans = ans;
      }
    }
    G = a[rd[Math.ceil(Math.random() * Math.random() * tot * tot * tot) % l + 1]];
  }
  let t = '';
  for (let i = 1; i <= 4; i++)t = t + String(getn(G, i));
  document.getElementById("inf").innerHTML = document.getElementById("inf").innerHTML + 'Attempt ' + String(tern) + ': ' + t + ' (' + String(pre) + ')';
  //document.getElementById("inf").innerHTML=String(l);
}
function kill() {
  if (init1 == 0) {
    document.getElementById("inf").innerHTML = 'Game has not started'; return;
  }
  if (isright == 1) {
    document.getElementById("inf").innerHTML = document.getElementById("inf").innerHTML + '<br>Hit the answer in ' + String(tern) + ' steps!'; init1 = 0;
    return;
  }
  let gusA = document.getElementById("reA").value, gusB = document.getElementById("reB").value, A, B, ill = 0;
  if (isNaN(gusA) || isNaN(gusB) || gusA == '' || gusB == '') ill = 1;
  else {
    A = Number(gusA); B = Number(gusB);
    if (A < 0 || B < 0 || A > 4 || B > 4 || A + B > 4) ill = 1;
  }
  if (ill == 1) {
    document.getElementById("inf").innerHTML = document.getElementById("inf").innerHTML + '<br>Wrong Input!<br>'; return;
  }
  lA = A;
  if (A == 4) {
    document.getElementById("inf").innerHTML = document.getElementById("inf").innerHTML + '<br>Hit the answer in ' + String(tern) + ' steps!'; init1 = 0;
    return;
  }
  let count = 0;
  for (let i = 1; i <= tot; i++) {
    if (b[i] == 1 && ((compA(a[i], G) != A || compB(a[i], G) != B) || a[i] == G)) b[i] = 0;
    if (b[i] == 1) count++;
  }
  if (count == 0) {
    document.getElementById("inf").innerHTML = document.getElementById("inf").innerHTML + '<br>Wrong Input!<br>'; init1 = 0; return;
  }
  document.getElementById("inf").innerHTML = document.getElementById("inf").innerHTML + ' ' + String(gusA) + 'A ' + String(gusB) + 'B<br>';
  makeguess();
}
function result() {
  isright = 1;
  kill();
}
</script>
]]></content>
      <tags>
        <tag>Fun Stuff</tag>
      </tags>
  </entry>
  <entry>
    <title>Goodbye World</title>
    <url>/2022/04/26/Goodbye-World/</url>
    <content><![CDATA[<h2 id="This-is-my-First-Hexo-Blog"><a href="#This-is-my-First-Hexo-Blog" class="headerlink" title="This is my First Hexo Blog"></a>This is my First Hexo Blog</h2><p>Goodbye world! (Why not ‘Hello World!’, you might ask. That’s what people in the industry do. Well, that’s the reason. )</p>
<p>Test formula: $ \frac{x_1^2} {\sqrt{y_2^2} } $</p>
]]></content>
      <tags>
        <tag>Others</tag>
      </tags>
  </entry>
  <entry>
    <title>How to deploy Django</title>
    <url>/2022/04/27/How-to-deploy-Django/</url>
    <content><![CDATA[<p>Just follow the <a href="https://uwsgi-docs.readthedocs.io/en/latest/tutorials/Django_and_nginx.html">docs</a>. That’s it. However, I do find a few things wrong in the docs when I followed it. I rewrite those parts and add some comments.</p>
<h2 id="Some-notes-about-this-tutorial"><a href="#Some-notes-about-this-tutorial" class="headerlink" title="Some notes about this tutorial"></a>Some notes about this tutorial</h2><p>Note</p>
<p>This is a tutorial. It is not intended to provide a reference guide, never mind an exhaustive reference, to the subject of deployment.</p>
<p>nginx and uWSGI are good choices for Django deployment, but they are not the only ones, or the ‘official’ ones. There are excellent alternatives to both, and you are encouraged to investigate them.</p>
<p>The way we deploy Django here is a good way, but it is not the only way; for some purposes it is probably not even the best way.</p>
<p>It is however a reliable and easy way, and the material covered here will introduce you to concepts and procedures you will need to be familiar with whatever software you use for deploying Django. By providing you with a working setup, and rehearsing the steps you must take to get there, it will offer you a basis for exploring other ways to achieve this.</p>
<p>Note</p>
<p>This tutorial makes some assumptions about the system you are using.</p>
<p>It is assumed that you are using a Unix-like system, and that it features an aptitude-like package manager. However if you need to ask questions like “What’s the equivalent of aptitude on Mac OS X?”, you’ll be able to find that kind of help fairly easily.</p>
<p>While this tutorial assumes Django 1.4 or later, which will automatically create a wsgi module in your new project, the instructions will work with earlier versions. You will though need to obtain that Django wsgi module yourself, and you may find that the Django project directory structure is slightly different.</p>
<h2 id="Concept"><a href="#Concept" class="headerlink" title="Concept"></a>Concept</h2><p>A web server faces the outside world. It can serve files (HTML, images, CSS, etc) directly from the file system. However, it can’t talk directly to Django applications; it needs something that will run the application, feed it requests from web clients (such as browsers) and return responses.</p>
<p>A Web Server Gateway Interface - WSGI - does this job. WSGI is a Python standard.</p>
<p>uWSGI is a WSGI implementation. In this tutorial we will set up uWSGI so that it creates a Unix socket, and serves responses to the web server via the uwsgi protocol. At the end, our complete stack of components will look like this:</p>
<figure class="highlight text"><table><tr><td class="code"><pre><span class="line">the web client &lt;-&gt; the web server &lt;-&gt; the socket &lt;-&gt; uwsgi &lt;-&gt; Django</span><br></pre></td></tr></table></figure>
<h2 id="Before-you-start-setting-up-uWSGI"><a href="#Before-you-start-setting-up-uWSGI" class="headerlink" title="Before you start setting up uWSGI"></a>Before you start setting up uWSGI</h2><h3 id="virtual-env"><a href="#virtual-env" class="headerlink" title="virtual env"></a>virtual env</h3><p>Make sure you are in a virtualenv for the software we need to install (we will describe how to install a system-wide uwsgi later):</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">virtualenv uwsgi-tutorial</span><br><span class="line"><span class="built_in">cd</span> uwsgi-tutorial</span><br><span class="line"><span class="built_in">source</span> bin/activate</span><br></pre></td></tr></table></figure>
<h3 id="Django"><a href="#Django" class="headerlink" title="Django"></a>Django</h3><p>Install Django into your virtualenv, create a new project, and <code>cd</code> into the project:</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">pip install Django</span><br><span class="line">django-admin.py startproject mysite</span><br><span class="line"><span class="built_in">cd</span> mysite</span><br></pre></td></tr></table></figure>
<h3 id="About-the-domain-and-port"><a href="#About-the-domain-and-port" class="headerlink" title="About the domain and port"></a>About the domain and port</h3><p>In this tutorial we will call your domain <code>example.com</code>. Substitute your own FQDN or IP address.</p>
<p>Throughout, we’ll be using port 8000 for the web server to publish on, just like the Django runserver does by default. You can use whatever port you want of course, but I have chosen this one so it doesn’t conflict with anything a web server might be doing already.</p>
<h2 id="Basic-uWSGI-installation-and-configuration"><a href="#Basic-uWSGI-installation-and-configuration" class="headerlink" title="Basic uWSGI installation and configuration"></a>Basic uWSGI installation and configuration</h2><h3 id="Install-uWSGI-into-your-virtualenv"><a href="#Install-uWSGI-into-your-virtualenv" class="headerlink" title="Install uWSGI into your virtualenv"></a>Install uWSGI into your virtualenv</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">pip install uwsgi</span><br></pre></td></tr></table></figure>
<p>Of course there are other ways to install uWSGI, but this one is as good as any. Remember that you will need to have Python development packages installed. In the case of Debian, or Debian-derived systems such as Ubuntu, what you need to have installed is <code>pythonX.Y-dev</code>, where X.Y is your version of Python.</p>
<h3 id="Basic-test"><a href="#Basic-test" class="headerlink" title="Basic test"></a>Basic test</h3><p>Create a file called <code>test.py</code>:</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># test.py</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">application</span>(<span class="params">env, start_response</span>):</span><br><span class="line">    start_response(<span class="string">&#x27;200 OK&#x27;</span>, [(<span class="string">&#x27;Content-Type&#x27;</span>,<span class="string">&#x27;text/html&#x27;</span>)])</span><br><span class="line">    <span class="keyword">return</span> [<span class="string">b&quot;Hello World&quot;</span>] <span class="comment"># python3</span></span><br><span class="line">    <span class="comment">#return [&quot;Hello World&quot;] # python2</span></span><br></pre></td></tr></table></figure>
<p>Note</p>
<p>Take into account that Python 3 requires <code>bytes()</code>.</p>
<p>Run uWSGI:</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">uwsgi --http :8000 --wsgi-file test.py</span><br></pre></td></tr></table></figure>
<p>The options mean:</p>
<ul>
<li><code>http :8000</code>: use protocol http, port 8000</li>
<li><code>wsgi-file test.py</code>: load the specified file, test.py</li>
</ul>
<p>This should serve a ‘hello world’ message directly to the browser on port 8000. Visit: <code>http://example.com:8000</code> to check. If so, it means the following stack of components works:</p>
<figure class="highlight text"><table><tr><td class="code"><pre><span class="line">the web client &lt;-&gt; uWSGI &lt;-&gt; Python</span><br></pre></td></tr></table></figure>
<h3 id="Test-your-Django-project"><a href="#Test-your-Django-project" class="headerlink" title="Test your Django project"></a>Test your Django project</h3><p>Now we want uWSGI to do the same thing, but to run a Django site instead of the <code>test.py</code> module.</p>
<p>If you haven’t already done so, make sure that your <code>mysite</code> project actually works:</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">python manage.py runserver 0.0.0.0:8000</span><br></pre></td></tr></table></figure>
<p>And if that works, run it using uWSGI:</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">uwsgi --http :8000 --module mysite.wsgi</span><br></pre></td></tr></table></figure>
<ul>
<li><code>module mysite.wsgi</code>: load the specificied wsgi module</li>
</ul>
<p>Point your browser at the server; if the site appears, it means uWSGI is able to serve your Django application from your virtualenv, and this stack operates correctly:</p>
<figure class="highlight text"><table><tr><td class="code"><pre><span class="line">the web client &lt;-&gt; uWSGI &lt;-&gt; Django</span><br></pre></td></tr></table></figure>
<p>Now normally we won’t have the browser speaking directly to uWSGI. That’s a job for the webserver, which will act as a go-between.</p>
<h2 id="Basic-nginx"><a href="#Basic-nginx" class="headerlink" title="Basic nginx"></a>Basic nginx</h2><h3 id="Install-nginx"><a href="#Install-nginx" class="headerlink" title="Install nginx"></a>Install nginx</h3><p>To simple, I’ll skip this part.</p>
<p>Use <code>sudo /etc/init.d/nginx start</code> to start nginx and use <code>sudo nginx -s reload</code> to reload configurations.</p>
<h3 id="Configure-nginx-for-your-site"><a href="#Configure-nginx-for-your-site" class="headerlink" title="Configure nginx for your site"></a>Configure nginx for your site</h3><p>You will need the <code>uwsgi_params</code> file, which is available in the <code>nginx</code> directory of the uWSGI distribution, or from <a href="https://github.com/nginx/nginx/blob/master/conf/uwsgi_params">https://github.com/nginx/nginx/blob/master/conf/uwsgi_params</a></p>
<p>Copy it into your project directory. In a moment we will tell nginx to refer to it.</p>
<p>Now create a file called mysite_nginx.conf in the /etc/nginx/sites-available/ directory, and put this in it:</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># mysite_nginx.conf</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># the upstream component nginx needs to connect to</span></span><br><span class="line">upstream django &#123;</span><br><span class="line">    <span class="comment"># server unix:///path/to/your/mysite/mysite.sock; # for a file socket</span></span><br><span class="line">    server <span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>:<span class="number">8001</span>; <span class="comment"># for a web port socket (we&#x27;ll use this first)</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># configuration of the server</span></span><br><span class="line">server &#123;</span><br><span class="line">    <span class="comment"># the port your site will be served on</span></span><br><span class="line">    listen      <span class="number">8000</span>;</span><br><span class="line">    <span class="comment"># the domain name it will serve for</span></span><br><span class="line">    server_name example.com; <span class="comment"># substitute your machine&#x27;s IP address or FQDN</span></span><br><span class="line">    charset     utf-<span class="number">8</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment"># max upload size</span></span><br><span class="line">    client_max_body_size 75M;   <span class="comment"># adjust to taste</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># Django media</span></span><br><span class="line">    location /media  &#123;</span><br><span class="line">        alias /path/to/your/mysite/media;  <span class="comment"># your Django project&#x27;s media files - amend as required</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    location /static &#123;</span><br><span class="line">        alias /path/to/your/mysite/static; <span class="comment"># your Django project&#x27;s static files - amend as required</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment"># Finally, send all non-media requests to the Django server.</span></span><br><span class="line">    location / &#123;</span><br><span class="line">        uwsgi_pass  django;</span><br><span class="line">        include     /path/to/your/mysite/uwsgi_params; <span class="comment"># the uwsgi_params file you installed</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>This conf file tells nginx to serve up media and static files from the filesystem, as well as handle requests that require Django’s intervention. For a large deployment it is considered good practice to let one server handle static/media files, and another handle Django applications, but for now, this will do just fine.</p>
<p>Symlink to this file from /etc/nginx/sites-enabled so nginx can see it:</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo <span class="built_in">ln</span> -s /etc/nginx/sites-available/mysite_nginx.conf /etc/nginx/sites-enabled/</span><br></pre></td></tr></table></figure>
<h3 id="Deploying-static-files"><a href="#Deploying-static-files" class="headerlink" title="Deploying static files"></a>Deploying static files</h3><p>Before running nginx, you have to collect all Django static files in the static folder. First of all you have to edit mysite/settings.py adding:</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">STATIC_ROOT = os.path.join(BASE_DIR, <span class="string">&quot;static/&quot;</span>)</span><br></pre></td></tr></table></figure>
<p>and then run</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">python manage.py collectstatic</span><br></pre></td></tr></table></figure>
<h3 id="Basic-nginx-test"><a href="#Basic-nginx-test" class="headerlink" title="Basic nginx test"></a>Basic nginx test</h3><p>Restart nginx:</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo /etc/init.d/nginx restart</span><br></pre></td></tr></table></figure>
<p>To check that media files are being served correctly, add an image called <code>media.png</code> to the <code>/path/to/your/project/project/media</code> directory, then visit <a href="http://example.com:8000/media/media.png">http://example.com:8000/media/media.png</a> - if this works, you’ll know at least that nginx is serving files correctly.</p>
<p>It is worth not just restarting nginx, but actually stopping and then starting it again, which will inform you if there is a problem, and where it is.</p>
<h2 id="nginx-and-uWSGI-and-test-py"><a href="#nginx-and-uWSGI-and-test-py" class="headerlink" title="nginx and uWSGI and test.py"></a>nginx and uWSGI and test.py</h2><p>Let’s get nginx to speak to the “hello world” <code>test.py</code> application.</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">uwsgi --socket :8001 --wsgi-file test.py</span><br></pre></td></tr></table></figure>
<p>This is nearly the same as before, except this time one of the options is different:</p>
<ul>
<li><code>socket :8001</code>: use protocol uwsgi, port 8001</li>
</ul>
<p>nginx meanwhile has been configured to communicate with uWSGI on that port, and with the outside world on port 8000. Visit:</p>
<p><a href="http://example.com:8000/">http://example.com:8000/</a></p>
<p>to check. And this is our stack:</p>
<figure class="highlight text"><table><tr><td class="code"><pre><span class="line">the web client &lt;-&gt; the web server &lt;-&gt; the socket &lt;-&gt; uWSGI &lt;-&gt; Python</span><br></pre></td></tr></table></figure>
<p>Meanwhile, you can try to have a look at the uwsgi output at <a href="http://example.com:8001">http://example.com:8001</a> - but quite probably, it won’t work because your browser speaks http, not uWSGI, though you should see output from uWSGI in your terminal.</p>
<h2 id="Using-Unix-sockets-instead-of-ports"><a href="#Using-Unix-sockets-instead-of-ports" class="headerlink" title="Using Unix sockets instead of ports"></a>Using Unix sockets instead of ports</h2><p>So far we have used a TCP port socket, because it’s simpler, but in fact it’s better to use Unix sockets than ports - there’s less overhead.</p>
<p>Edit <code>mysite_nginx.conf</code>, changing it to match:</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">server unix:///path/to/your/mysite/mysite.sock; <span class="comment"># for a file socket</span></span><br><span class="line"><span class="comment"># server 127.0.0.1:8001; # for a web port socket (we&#x27;ll use this first)</span></span><br></pre></td></tr></table></figure>
<p>and restart nginx.</p>
<p>Run uWSGI again:</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">uwsgi --socket mysite.sock --wsgi-file test.py</span><br></pre></td></tr></table></figure>
<p>This time the <code>socket</code> option tells uWSGI which file to use.</p>
<p>Try <a href="http://example.com:8000/">http://example.com:8000/</a> in the browser.</p>
<h3 id="If-that-doesn’t-work"><a href="#If-that-doesn’t-work" class="headerlink" title="If that doesn’t work"></a>If that doesn’t work</h3><p>Check your nginx error log(/var/log/nginx/error.log). If you see something like:</p>
<figure class="highlight text"><table><tr><td class="code"><pre><span class="line">connect() to unix:///path/to/your/mysite/mysite.sock failed (13: Permission</span><br><span class="line">denied)</span><br></pre></td></tr></table></figure>
<p>then probably you need to manage the permissions on the socket so that nginx is allowed to use it.</p>
<p>Try:</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">uwsgi --socket mysite.sock --wsgi-file test.py --chmod-socket=666 <span class="comment"># (very permissive)</span></span><br></pre></td></tr></table></figure>
<p>↑This works for me and ↓this does not</p>
<p>or:</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">uwsgi --socket mysite.sock --wsgi-file test.py --chmod-socket=664 <span class="comment"># (more sensible)</span></span><br></pre></td></tr></table></figure>
<p>You may also have to add your user to nginx’s group (which is probably www-data), or vice-versa, so that nginx can read and write to your socket properly.</p>
<p>It’s worth keeping the output of the nginx log running in a terminal window so you can easily refer to it while troubleshooting.</p>
<h2 id="Running-the-Django-application-with-uwsgi-and-nginx"><a href="#Running-the-Django-application-with-uwsgi-and-nginx" class="headerlink" title="Running the Django application with uwsgi and nginx"></a>Running the Django application with uwsgi and nginx</h2><p>Let’s run our Django application:</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">uwsgi --socket mysite.sock --module mysite.wsgi --chmod-socket=666</span><br></pre></td></tr></table></figure>
<p>Note that in the original docs, this command is</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">uwsgi --socket mysite.sock --module mysite.wsgi --chmod-socket=664</span><br></pre></td></tr></table></figure>
<p>but it does not work for me.</p>
<p>Now uWSGI and nginx should be serving up not just a “Hello World” module, but your Django project.</p>
<h2 id="Now-uWSGI-and-nginx-should-be-serving-up-not-just-a-“Hello-World”-module-but-your-Django-project"><a href="#Now-uWSGI-and-nginx-should-be-serving-up-not-just-a-“Hello-World”-module-but-your-Django-project" class="headerlink" title="Now uWSGI and nginx should be serving up not just a “Hello World” module, but your Django project"></a>Now uWSGI and nginx should be serving up not just a “Hello World” module, but your Django project</h2><p>We can put the same options that we used with uWSGI into a file, and then ask uWSGI to run with that file. It makes it easier to manage configurations.</p>
<p>Create a file called <code>mysite_uwsgi.ini</code>:</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># mysite_uwsgi.ini file</span></span><br><span class="line">[uwsgi]</span><br><span class="line"></span><br><span class="line"><span class="comment"># Django-related settings</span></span><br><span class="line"><span class="comment"># the base directory (full path)</span></span><br><span class="line">chdir           = /path/to/your/project</span><br><span class="line"><span class="comment"># Django&#x27;s wsgi file</span></span><br><span class="line">module          = project.wsgi</span><br><span class="line"><span class="comment"># the virtualenv (full path)</span></span><br><span class="line">home            = /path/to/virtualenv</span><br><span class="line"></span><br><span class="line"><span class="comment"># process-related settings</span></span><br><span class="line"><span class="comment"># master</span></span><br><span class="line">master          = true</span><br><span class="line"><span class="comment"># maximum number of worker processes</span></span><br><span class="line">processes       = <span class="number">10</span></span><br><span class="line"><span class="comment"># the socket (use the full path to be safe</span></span><br><span class="line">socket          = /path/to/your/project/mysite.sock</span><br><span class="line"><span class="comment"># ... with appropriate permissions - may be needed</span></span><br><span class="line"><span class="comment"># chmod-socket    = 664</span></span><br><span class="line"><span class="comment"># clear environment on exit</span></span><br><span class="line">vacuum          = true</span><br></pre></td></tr></table></figure>
<p>And run uwsgi using this file:</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">uwsgi --ini mysite_uwsgi.ini <span class="comment"># the --ini option is used to specify a file</span></span><br></pre></td></tr></table></figure>
<p>Once again, test that the Django site works as expected.</p>
<h2 id="Install-uWSGI-system-wide"><a href="#Install-uWSGI-system-wide" class="headerlink" title="Install uWSGI system-wide"></a>Install uWSGI system-wide</h2><p>So far, uWSGI is only installed in our virtualenv; we’ll need it installed system-wide for deployment purposes.</p>
<p>Deactivate your virtualenv using command: <code>deactivate</code></p>
<p>and install uWSGI system-wide:</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo pip install uwsgi</span><br><span class="line"></span><br><span class="line"><span class="comment"># Or install LTS (long term support).</span></span><br><span class="line">pip install https://projects.unbit.it/downloads/uwsgi-lts.tar.gz</span><br></pre></td></tr></table></figure>
<p>The uWSGI wiki describes several installation procedures. Before installing uWSGI system-wide, it’s worth considering which version to choose and the most apppropriate way of installing it.</p>
<p>Check again that you can still run uWSGI just like you did before:</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">uwsgi --ini mysite_uwsgi.ini <span class="comment"># the --ini option is used to specify a file</span></span><br></pre></td></tr></table></figure>
<h2 id="Emperor-mode"><a href="#Emperor-mode" class="headerlink" title="Emperor mode"></a>Emperor mode</h2><p>uWSGI can run in ‘emperor’ mode. In this mode it keeps an eye on a directory of uWSGI config files, and will spawn instances (‘vassals’) for each one it finds.</p>
<p>Whenever a config file is amended, the emperor will automatically restart the vassal.</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># create a directory for the vassals</span></span><br><span class="line">sudo <span class="built_in">mkdir</span> -p /etc/uwsgi/vassals</span><br><span class="line"><span class="comment"># symlink from the default config directory to your config file</span></span><br><span class="line">sudo <span class="built_in">ln</span> -s /path/to/your/mysite/mysite_uwsgi.ini /etc/uwsgi/vassals/</span><br><span class="line"><span class="comment"># run the emperor</span></span><br><span class="line">uwsgi --emperor /etc/uwsgi/vassals --uid www-data --gid www-data</span><br></pre></td></tr></table></figure>
<p>You may need to run uWSGI with sudo (I need not)</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo uwsgi --emperor /etc/uwsgi/vassals --uid www-data --gid www-data</span><br></pre></td></tr></table></figure>
<p>The options mean:</p>
<ul>
<li><code>emperor</code>: where to look for vassals (config files)</li>
<li><code>uid</code>: the user id of the process once it’s started</li>
<li><code>gid</code>: the group id of the process once it’s started</li>
</ul>
<p>Check the site; it should be running.</p>
<h2 id="Check-the-site-it-should-be-running"><a href="#Check-the-site-it-should-be-running" class="headerlink" title="Check the site; it should be running"></a>Check the site; it should be running</h2><p>The last step is to make it all happen automatically at system startup time.</p>
<p>For many systems, the easiest (if not the best) way to do this is to use the <code>rc.local</code> file.</p>
<p>Edit <code>/etc/rc.local</code> and add:</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">/usr/local/bin/uwsgi --emperor /etc/uwsgi/vassals --uid www-data --gid www-data --daemonize /var/log/uwsgi-emperor.log</span><br></pre></td></tr></table></figure>
<p>before the line <code>exit 0</code>. <strong>(Important)</strong></p>
<p>And that should be it!</p>
<h2 id="Further-configuration"><a href="#Further-configuration" class="headerlink" title="Further configuration"></a>Further configuration</h2><p>It is important to understand that this has been a tutorial, to get you started. You do need to read the nginx and uWSGI documentation, and study the options available before deployment in a production environment.</p>
<p>Both nginx and uWSGI benefit from friendly communities, who are able to offer invaluable advice about configuration and usage.</p>
<h3 id="nginx"><a href="#nginx" class="headerlink" title="nginx"></a>nginx</h3><p>It is important to understand that this has been a tutorial, to get you started. You do need to read the nginx and uWSGI documentation, and study the options available before deployment in a production environment.</p>
<p>Both nginx and uWSGI benefit from friendly communities, who are able to offer invaluable advice about configuration and usage.</p>
<h3 id="uWSGI"><a href="#uWSGI" class="headerlink" title="uWSGI"></a>uWSGI</h3><p>It is important to understand that this has been a tutorial, to get you started. You do need to read the nginx and uWSGI documentation, and study the options available before deployment in a production environment.</p>
<p>Both nginx and uWSGI benefit from friendly communities, who are able to offer invaluable advice about configuration and usage.</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">env = DJANGO_SETTINGS_MODULE=mysite.settings <span class="comment"># set an environment variable</span></span><br><span class="line">safe-pidfile = /tmp/project-master.pid <span class="comment"># create a pidfile</span></span><br><span class="line">harakiri = <span class="number">20</span> <span class="comment"># respawn processes taking more than 20 seconds</span></span><br><span class="line">limit-<span class="keyword">as</span> = <span class="number">128</span> <span class="comment"># limit the project to 128 MB</span></span><br><span class="line"><span class="built_in">max</span>-requests = <span class="number">5000</span> <span class="comment"># respawn processes after serving 5000 requests</span></span><br><span class="line">daemonize = /var/log/uwsgi/yourproject.log <span class="comment"># background the process &amp; log</span></span><br></pre></td></tr></table></figure>
]]></content>
      <tags>
        <tag>nginx</tag>
        <tag>Web Dev</tag>
        <tag>Backend</tag>
        <tag>Django</tag>
        <tag>Tutorial</tag>
      </tags>
  </entry>
  <entry>
    <title>Git Learning Notes</title>
    <url>/2022/04/28/Git-Learning-Notes/</url>
    <content><![CDATA[<h2 id="Git-Commit-Messages-in-Appropriate-Formatting"><a href="#Git-Commit-Messages-in-Appropriate-Formatting" class="headerlink" title="Git Commit Messages in Appropriate Formatting"></a>Git Commit Messages in Appropriate Formatting</h2><p>Reference: <a href="https://www.freecodecamp.org/news/writing-good-commit-messages-a-practical-guide/">How to Write Good Commit Messages: A Practical Git Guide</a></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">git commit -m <span class="string">&#x27;&lt;type&gt;: &lt;verb&gt; &lt;object&gt;&#x27;</span></span><br></pre></td></tr></table></figure>
<p>type:</p>
<ul>
<li><p><code>feat</code>: add a new feature</p>
</li>
<li><p><code>fix</code>: fix a bug</p>
</li>
<li><p><code>style</code>: change the coding style without any other functional changes</p>
</li>
<li><p><code>refactor</code>: rewrite</p>
</li>
<li><p><code>test</code>: everything related to testing</p>
</li>
<li><p><code>docs</code>: everything related to documentation</p>
</li>
<li><p><code>chore</code>: regular maintenance</p>
</li>
</ul>
<h2 id="Branch-Related"><a href="#Branch-Related" class="headerlink" title="Branch Related"></a>Branch Related</h2><p>Create new branch</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">git branch anyNameYouLike</span><br></pre></td></tr></table></figure>
<p>List all branches</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">git branch</span><br></pre></td></tr></table></figure>
<p>Switch between different branches locally</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">git checkout nameOfTargetedBranch</span><br></pre></td></tr></table></figure>
<h2 id="Push-Related"><a href="#Push-Related" class="headerlink" title="Push Related"></a>Push Related</h2><p>Set/change upstream</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">git push --set-upstream origin nameOfUpStream</span><br></pre></td></tr></table></figure>
]]></content>
      <tags>
        <tag>Notes</tag>
        <tag>Git</tag>
      </tags>
  </entry>
  <entry>
    <title>Matlab Learning Notes</title>
    <url>/2022/04/27/Matlab-Learning-Notes/</url>
    <content><![CDATA[<p>Docs: <a href="https://ww2.mathworks.cn/help/?requestedDomain=en">MATLAB Help Center</a></p>
<h2 id="Things-Unique-to-MATLAB"><a href="#Things-Unique-to-MATLAB" class="headerlink" title="Things Unique to MATLAB"></a>Things Unique to MATLAB</h2><h3 id="Function-Handle-a-unique-class"><a href="#Function-Handle-a-unique-class" class="headerlink" title="Function Handle (a unique class)"></a>Function Handle (a unique class)</h3><p>Docs: <a href="https://ww2.mathworks.cn/help/matlab/ref/function_handle.html?searchHighlight=function%20handle&amp;s_tid=srchtitle_function%20handle_2">function handle</a></p>
<figure class="highlight matlab"><table><tr><td class="code"><pre><span class="line">&gt;&gt; f = @(x) x^<span class="number">2</span><span class="number">-3</span>*x+<span class="number">1</span></span><br><span class="line"></span><br><span class="line">f =</span><br><span class="line"></span><br><span class="line">  function_handle with value:</span><br><span class="line"></span><br><span class="line">    @(x)x^<span class="number">2</span><span class="number">-3</span>*x+<span class="number">1</span></span><br><span class="line"></span><br><span class="line">&gt;&gt; f(<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">ans</span> =</span><br><span class="line"></span><br><span class="line">    <span class="number">-1</span></span><br></pre></td></tr></table></figure>
<h2 id="Add-Fonts-to-MATLAB"><a href="#Add-Fonts-to-MATLAB" class="headerlink" title="Add Fonts to MATLAB"></a>Add Fonts to MATLAB</h2><p>Reference: <a href="https://ww2.mathworks.cn/matlabcentral/answers/514119-can-i-add-custom-fonts-to-my-matlab-desktop-in-preferences">Can I add custom fonts to my MATLAB Desktop in Preferences?</a></p>
<p>Basically, copy <code>ttf</code> font files to <code>\matlabRoot\sys\java\jre\win64\jre\lib\fonts</code>, restart MATLAB, and choose the font in the MATLAB preferences.</p>
<h2 id="Array-Related"><a href="#Array-Related" class="headerlink" title="Array Related"></a>Array Related</h2><h3 id="and-Merge-Arrays"><a href="#and-Merge-Arrays" class="headerlink" title="[;] and [,] | Merge Arrays"></a>[;] and [,] | Merge Arrays</h3><figure class="highlight matlab"><table><tr><td class="code"><pre><span class="line">&gt;&gt; x=[<span class="number">3</span>;<span class="number">2</span>;<span class="number">6</span>;<span class="number">8</span>]</span><br><span class="line"></span><br><span class="line">x =</span><br><span class="line"></span><br><span class="line">     <span class="number">3</span></span><br><span class="line">     <span class="number">2</span></span><br><span class="line">     <span class="number">6</span></span><br><span class="line">     <span class="number">8</span></span><br><span class="line"></span><br><span class="line">&gt;&gt; y=[<span class="number">4</span>;<span class="number">1</span>;<span class="number">3</span>;<span class="number">5</span>]</span><br><span class="line"></span><br><span class="line">y =</span><br><span class="line"></span><br><span class="line">     <span class="number">4</span></span><br><span class="line">     <span class="number">1</span></span><br><span class="line">     <span class="number">3</span></span><br><span class="line">     <span class="number">5</span></span><br><span class="line"></span><br><span class="line"><span class="comment">% merge several arrays in a vertical way; use &#x27;,&#x27; to merge them in a horizontal way</span></span><br><span class="line">&gt;&gt; y=[y;sum(x)]</span><br><span class="line"></span><br><span class="line">y =</span><br><span class="line"></span><br><span class="line">     <span class="number">4</span></span><br><span class="line">     <span class="number">1</span></span><br><span class="line">     <span class="number">3</span></span><br><span class="line">     <span class="number">5</span></span><br><span class="line">    <span class="number">19</span></span><br></pre></td></tr></table></figure>
<h3 id="Array-Indexing"><a href="#Array-Indexing" class="headerlink" title="(:,:) | Array Indexing"></a>(:,:) | Array Indexing</h3><figure class="highlight matlab"><table><tr><td class="code"><pre><span class="line"><span class="comment">% anyArrayNameYouLike(startRow:endRow,startColumn:endColumn)</span></span><br><span class="line">&gt;&gt; y(<span class="number">1</span>:<span class="number">4</span>,:)  </span><br><span class="line"></span><br><span class="line"><span class="built_in">ans</span> =</span><br><span class="line"></span><br><span class="line">     <span class="number">4</span></span><br><span class="line">     <span class="number">1</span></span><br><span class="line">     <span class="number">3</span></span><br><span class="line">     <span class="number">5</span></span><br><span class="line"></span><br><span class="line">&gt;&gt; y=<span class="built_in">ans</span></span><br><span class="line"></span><br><span class="line">y =</span><br><span class="line"></span><br><span class="line">     <span class="number">4</span></span><br><span class="line">     <span class="number">1</span></span><br><span class="line">     <span class="number">3</span></span><br><span class="line">     <span class="number">5</span></span><br></pre></td></tr></table></figure>
<h3 id="Element-wise-Calculations"><a href="#Element-wise-Calculations" class="headerlink" title=".^ .* ./ | Element-wise Calculations"></a>.^ .* ./ | Element-wise Calculations</h3><figure class="highlight matlab"><table><tr><td class="code"><pre><span class="line"><span class="comment">% use &#x27;.&#x27; before calculation marks to perform element-wise calculations rather than matrix calculations</span></span><br><span class="line">&gt;&gt; x.^y</span><br><span class="line"></span><br><span class="line"><span class="built_in">ans</span> =</span><br><span class="line"></span><br><span class="line">          <span class="number">81</span></span><br><span class="line">           <span class="number">2</span></span><br><span class="line">         <span class="number">216</span></span><br><span class="line">       <span class="number">32768</span></span><br></pre></td></tr></table></figure>
<h3 id="‘-Transpose-a-Matrix"><a href="#‘-Transpose-a-Matrix" class="headerlink" title="‘ | Transpose a Matrix"></a>‘ | Transpose a Matrix</h3><figure class="highlight matlab"><table><tr><td class="code"><pre><span class="line">&gt;&gt; x&#x27;</span><br><span class="line"></span><br><span class="line"><span class="built_in">ans</span> =</span><br><span class="line"></span><br><span class="line">     <span class="number">3</span>     <span class="number">2</span>     <span class="number">6</span>     <span class="number">8</span></span><br><span class="line"> </span><br><span class="line">&gt;&gt; w=sum(x.*y)</span><br><span class="line"></span><br><span class="line">w =</span><br><span class="line"></span><br><span class="line">    <span class="number">72</span></span><br><span class="line"></span><br><span class="line">&gt;&gt; x&#x27;*y-w</span><br><span class="line"></span><br><span class="line"><span class="built_in">ans</span> =</span><br><span class="line"></span><br><span class="line">     <span class="number">0</span></span><br><span class="line"></span><br><span class="line">&gt;&gt; A=[<span class="number">1</span>,<span class="number">3</span>,<span class="number">5</span>]</span><br><span class="line"></span><br><span class="line">A =</span><br><span class="line"></span><br><span class="line">     <span class="number">1</span>     <span class="number">3</span>     <span class="number">5</span></span><br><span class="line"></span><br><span class="line">&gt;&gt; B=[<span class="number">3</span>,<span class="number">6</span>,<span class="number">9</span>]</span><br><span class="line"></span><br><span class="line">B =</span><br><span class="line"></span><br><span class="line">     <span class="number">3</span>     <span class="number">6</span>     <span class="number">9</span></span><br></pre></td></tr></table></figure>
<h3 id="union-A-B-Merge-Multiple-Arrays-without-Repetition"><a href="#union-A-B-Merge-Multiple-Arrays-without-Repetition" class="headerlink" title="union(A,B) | Merge Multiple Arrays without Repetition"></a>union(A,B) | Merge Multiple Arrays without Repetition</h3><figure class="highlight matlab"><table><tr><td class="code"><pre><span class="line">&gt;&gt; union(A,B)</span><br><span class="line"></span><br><span class="line"><span class="built_in">ans</span> =</span><br><span class="line"></span><br><span class="line">     <span class="number">1</span>     <span class="number">3</span>     <span class="number">5</span>     <span class="number">6</span>     <span class="number">9</span></span><br></pre></td></tr></table></figure>
<h2 id="Functions"><a href="#Functions" class="headerlink" title="Functions"></a>Functions</h2><h3 id="isequal-A1-A2-A3-…-An-Determine-Array-Equality"><a href="#isequal-A1-A2-A3-…-An-Determine-Array-Equality" class="headerlink" title="isequal(A1,A2,A3,…,An) | Determine Array Equality"></a>isequal(A1,A2,A3,…,An) | Determine Array Equality</h3><p>Simple to understand.</p>
<p>To be noticed, <code>string</code> and <code>char</code> is also a type of array.</p>
<h3 id="isa-variable-char-Whether-a-Variable-is-a-Certain-Type"><a href="#isa-variable-char-Whether-a-Variable-is-a-Certain-Type" class="headerlink" title="isa(variable,char) | Whether a Variable is a Certain Type"></a>isa(variable,char) | Whether a Variable is a Certain Type</h3><figure class="highlight matlab"><table><tr><td class="code"><pre><span class="line">&gt;&gt; s=<span class="number">1234</span></span><br><span class="line"></span><br><span class="line">s =</span><br><span class="line"></span><br><span class="line">        <span class="number">1234</span></span><br><span class="line"></span><br><span class="line">&gt;&gt; isa(s,<span class="string">&#x27;double&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">ans</span> =</span><br><span class="line"></span><br><span class="line">  logical</span><br><span class="line"></span><br><span class="line">   <span class="number">1</span></span><br><span class="line"></span><br><span class="line">&gt;&gt; isa(s,<span class="string">&#x27;string&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">ans</span> =</span><br><span class="line"></span><br><span class="line">  logical</span><br><span class="line"></span><br><span class="line">   <span class="number">0</span></span><br></pre></td></tr></table></figure>
<h3 id="class-variable-Get-Class-Type-of-a-Variable"><a href="#class-variable-Get-Class-Type-of-a-Variable" class="headerlink" title="class(variable) | Get Class/Type of a Variable"></a>class(variable) | Get Class/Type of a Variable</h3><figure class="highlight matlab"><table><tr><td class="code"><pre><span class="line">&gt;&gt; s=<span class="number">1234</span></span><br><span class="line"></span><br><span class="line">s =</span><br><span class="line"></span><br><span class="line">        <span class="number">1234</span></span><br><span class="line"></span><br><span class="line">&gt;&gt; class(s)</span><br><span class="line"></span><br><span class="line"><span class="built_in">ans</span> =</span><br><span class="line"></span><br><span class="line">    <span class="string">&#x27;double&#x27;</span></span><br></pre></td></tr></table></figure>
<h3 id="prod-array-Product-of-an-Array"><a href="#prod-array-Product-of-an-Array" class="headerlink" title="prod(array) | Product of an Array"></a>prod(array) | Product of an Array</h3><figure class="highlight matlab"><table><tr><td class="code"><pre><span class="line">&gt;&gt; prod([<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>])</span><br><span class="line"></span><br><span class="line"><span class="built_in">ans</span> =</span><br><span class="line"></span><br><span class="line">    <span class="number">24</span></span><br></pre></td></tr></table></figure>
<h3 id="primes-n-Primes"><a href="#primes-n-Primes" class="headerlink" title="primes(n) | Primes"></a>primes(n) | Primes</h3><figure class="highlight matlab"><table><tr><td class="code"><pre><span class="line">p = <span class="built_in">primes</span>(n) </span><br><span class="line"><span class="comment">%returns a row vector containing all the prime numbers less than or equal to n. The data type of p is the same as that of n.</span></span><br></pre></td></tr></table></figure>
<h3 id="strfind-str-substr-Locate-substr-in-str"><a href="#strfind-str-substr-Locate-substr-in-str" class="headerlink" title="strfind(str, substr) | Locate substr in str"></a>strfind(str, substr) | Locate substr in str</h3><figure class="highlight matlab"><table><tr><td class="code"><pre><span class="line">&gt;&gt; str = <span class="string">&#x27;Find the starting indices of substrings in a character vector&#x27;</span>;</span><br><span class="line">&gt;&gt; k = strfind(str,<span class="string">&#x27;in&#x27;</span>)</span><br><span class="line"></span><br><span class="line">k =</span><br><span class="line"></span><br><span class="line">     <span class="number">2</span>    <span class="number">15</span>    <span class="number">19</span>    <span class="number">36</span>    <span class="number">41</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h3 id="input-prompt-argument-Input"><a href="#input-prompt-argument-Input" class="headerlink" title="input(prompt, argument) | Input"></a>input(prompt, argument) | Input</h3><figure class="highlight matlab"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line">someVarialbleName=input(prompt)</span><br><span class="line"><span class="comment">% where prompt is a string (can be empty) that pops up before user input</span></span><br><span class="line"><span class="comment">% If you want to input a string, use:</span></span><br><span class="line">someStringVariableName=input(<span class="string">&quot;&quot;</span>,<span class="string">&quot;s&quot;</span>)</span><br></pre></td></tr></table></figure>
<h3 id="disp-array-Output"><a href="#disp-array-Output" class="headerlink" title="disp(array) | Output"></a>disp(array) | Output</h3><figure class="highlight matlab"><table><tr><td class="code"><pre><span class="line">x=[<span class="number">1</span>,<span class="number">2</span>]</span><br><span class="line"><span class="built_in">disp</span>(x)</span><br></pre></td></tr></table></figure>
<h3 id="amp-amp-Logic-Calculation"><a href="#amp-amp-Logic-Calculation" class="headerlink" title="~ || &amp;&amp; | Logic Calculation"></a>~ || &amp;&amp; | Logic Calculation</h3><figure class="highlight matlab"><table><tr><td class="code"><pre><span class="line">&gt;&gt; ~<span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">ans</span> =</span><br><span class="line"></span><br><span class="line">  logical</span><br><span class="line"></span><br><span class="line">   <span class="number">0</span></span><br><span class="line"></span><br><span class="line">&gt;&gt; <span class="number">1</span> &amp;&amp; <span class="number">0</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">ans</span> =</span><br><span class="line"></span><br><span class="line">  logical</span><br><span class="line"></span><br><span class="line">   <span class="number">0</span></span><br><span class="line"></span><br><span class="line">&gt;&gt; <span class="number">1</span> || <span class="number">0</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">ans</span> =</span><br><span class="line"></span><br><span class="line">  logical</span><br><span class="line"></span><br><span class="line">   <span class="number">1</span></span><br></pre></td></tr></table></figure>
<h3 id="mod-n-m-fix-n-Take-the-Round-and-Mod"><a href="#mod-n-m-fix-n-Take-the-Round-and-Mod" class="headerlink" title="mod(n, m) fix(n) | Take the Round and Mod"></a>mod(n, m) fix(n) | Take the Round and Mod</h3><figure class="highlight matlab"><table><tr><td class="code"><pre><span class="line"><span class="comment">% mod</span></span><br><span class="line">&gt;&gt; <span class="built_in">mod</span>(<span class="number">5</span>,<span class="number">2</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">ans</span> =</span><br><span class="line"></span><br><span class="line">     <span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="comment">% fix: towards 0</span></span><br><span class="line">&gt;&gt; <span class="built_in">fix</span>(<span class="number">1.1</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">ans</span> =</span><br><span class="line"></span><br><span class="line">     <span class="number">1</span></span><br><span class="line"></span><br><span class="line">&gt;&gt; <span class="built_in">fix</span>(<span class="number">-1.1</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">ans</span> =</span><br><span class="line"></span><br><span class="line">    <span class="number">-1</span></span><br></pre></td></tr></table></figure>
<h3 id="length-array-strlength-string-The-Length-of-an-Array-and-a-String"><a href="#length-array-strlength-string-The-Length-of-an-Array-and-a-String" class="headerlink" title="length(array) strlength(string) | The Length of an Array and a String"></a>length(array) strlength(string) | The Length of an Array and a String</h3><figure class="highlight matlab"><table><tr><td class="code"><pre><span class="line">&gt;&gt; x=[<span class="number">3</span>;<span class="number">2</span>;<span class="number">6</span>;<span class="number">8</span>]</span><br><span class="line"></span><br><span class="line">x =</span><br><span class="line"></span><br><span class="line">     <span class="number">3</span></span><br><span class="line">     <span class="number">2</span></span><br><span class="line">     <span class="number">6</span></span><br><span class="line">     <span class="number">8</span></span><br><span class="line"></span><br><span class="line">&gt;&gt; <span class="built_in">length</span>(x)</span><br><span class="line"></span><br><span class="line"><span class="built_in">ans</span> =</span><br><span class="line"></span><br><span class="line">     <span class="number">4</span></span><br><span class="line"></span><br><span class="line">&gt;&gt; s=<span class="string">&quot;This is a string&quot;</span></span><br><span class="line"></span><br><span class="line">s =</span><br><span class="line"></span><br><span class="line">    <span class="string">&quot;This is a string&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">% Also, I find length() can do the job as well</span></span><br><span class="line">&gt;&gt; strlength(s)</span><br><span class="line"></span><br><span class="line"><span class="built_in">ans</span> =</span><br><span class="line"></span><br><span class="line">    <span class="number">16</span></span><br><span class="line"></span><br><span class="line"><span class="comment">% Use &#x27;&#x27; to wrap things that is not logically a string.</span></span><br><span class="line">&gt;&gt; s=<span class="string">&#x27;GCTA&#x27;</span> <span class="comment">% a DNA sequence</span></span><br><span class="line"></span><br><span class="line">s =</span><br><span class="line"></span><br><span class="line">    <span class="string">&#x27;GCTA&#x27;</span></span><br></pre></td></tr></table></figure>
<h3 id="min-max-bounds-array-Get-Min-and-Max-in-an-Array"><a href="#min-max-bounds-array-Get-Min-and-Max-in-an-Array" class="headerlink" title="[min, max]=bounds(array) | Get Min and Max in an Array"></a>[min, max]=bounds(array) | Get Min and Max in an Array</h3><figure class="highlight matlab"><table><tr><td class="code"><pre><span class="line">&gt;&gt; A</span><br><span class="line"></span><br><span class="line">A =</span><br><span class="line"></span><br><span class="line">     <span class="number">1</span>     <span class="number">3</span>     <span class="number">5</span></span><br><span class="line"></span><br><span class="line">&gt;&gt; [minA,maxA]=bounds(A)</span><br><span class="line"></span><br><span class="line">minA =</span><br><span class="line"></span><br><span class="line">     <span class="number">1</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">maxA =</span><br><span class="line"></span><br><span class="line">     <span class="number">5</span></span><br></pre></td></tr></table></figure>
<h3 id="clc-Clear-Screen"><a href="#clc-Clear-Screen" class="headerlink" title="clc | Clear Screen"></a>clc | Clear Screen</h3><figure class="highlight matlab"><table><tr><td class="code"><pre><span class="line">&gt;&gt; clc</span><br></pre></td></tr></table></figure>
<h3 id="randi-Get-Random-Int"><a href="#randi-Get-Random-Int" class="headerlink" title="randi() | Get Random Int"></a>randi() | Get Random Int</h3><p>Docs: <a href="https://ww2.mathworks.cn/help/matlab/ref/randi.html?searchHighlight=randi&amp;s_tid=srchtitle_randi_1">randi()</a></p>
<figure class="highlight matlab"><table><tr><td class="code"><pre><span class="line">&gt;&gt; randi([<span class="number">1</span>,<span class="number">3</span>])</span><br><span class="line"></span><br><span class="line"><span class="built_in">ans</span> =</span><br><span class="line"></span><br><span class="line">     <span class="number">3</span></span><br><span class="line"></span><br><span class="line">&gt;&gt; randi([<span class="number">1</span>,<span class="number">10</span>],<span class="number">1</span>,<span class="number">5</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">ans</span> =</span><br><span class="line"></span><br><span class="line">     <span class="number">6</span>     <span class="number">2</span>     <span class="number">7</span>     <span class="number">3</span>     <span class="number">7</span></span><br></pre></td></tr></table></figure>
<h2 id="Plot-Related"><a href="#Plot-Related" class="headerlink" title="Plot Related"></a>Plot Related</h2><p>Docs: <a href="https://ww2.mathworks.cn/help/matlab/learn_matlab/plots.html">2-D and 3-D Plots</a></p>
<figure class="highlight matlab"><table><tr><td class="code"><pre><span class="line">x = <span class="built_in">linspace</span>(<span class="number">0</span>,<span class="number">2</span>*<span class="built_in">pi</span>);</span><br><span class="line">y = <span class="built_in">sin</span>(x);</span><br><span class="line"><span class="built_in">plot</span>(x,y)</span><br><span class="line">xlabel(<span class="string">&quot;x&quot;</span>)</span><br><span class="line">ylabel(<span class="string">&quot;sin(x)&quot;</span>)</span><br><span class="line">title(<span class="string">&quot;Plot of the Sine Function&quot;</span>)</span><br><span class="line"><span class="built_in">plot</span>(x,y,<span class="string">&quot;r--&quot;</span>) <span class="comment">% plot using red dashed line</span></span><br><span class="line"><span class="built_in">plot</span>(x,y,<span class="string">&quot;r:o&quot;</span>)</span><br><span class="line"><span class="built_in">plot</span>(x,y,<span class="string">&quot;b:*&quot;</span>)</span><br></pre></td></tr></table></figure>
<p>Notice that the titles and labels that you defined for the first plot are no longer in the current figure window. By default, MATLAB clears the figure each time you call a plotting function, resetting the axes and other elements to prepare the new plot.</p>
<p>To add plots to an existing figure, use <code>hold on</code>. Until you use <code>hold off</code> or close the window, all plots appear in the current figure window.</p>
<figure class="highlight matlab"><table><tr><td class="code"><pre><span class="line">x = <span class="built_in">linspace</span>(<span class="number">0</span>,<span class="number">2</span>*<span class="built_in">pi</span>);</span><br><span class="line">y = <span class="built_in">sin</span>(x);</span><br><span class="line"><span class="built_in">plot</span>(x,y)</span><br><span class="line"></span><br><span class="line"><span class="built_in">hold</span> on</span><br><span class="line"></span><br><span class="line">y2 = <span class="built_in">cos</span>(x);</span><br><span class="line"><span class="built_in">plot</span>(x,y2,<span class="string">&quot;:&quot;</span>)</span><br><span class="line"><span class="built_in">legend</span>(<span class="string">&quot;sin&quot;</span>,<span class="string">&quot;cos&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">hold</span> off</span><br></pre></td></tr></table></figure>
<h2 id="Scripts-Related"><a href="#Scripts-Related" class="headerlink" title="Scripts Related"></a>Scripts Related</h2><p>Docs: <a href="https://ww2.mathworks.cn/help/matlab/learn_matlab/scripts.html">Programming and Scripts</a></p>
<h3 id="Write-Custom-Functions"><a href="#Write-Custom-Functions" class="headerlink" title="Write Custom Functions"></a>Write Custom Functions</h3><figure class="highlight matlab"><table><tr><td class="code"><pre><span class="line"><span class="comment">% y are outputs and x are input</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="params">[y1,...,yN]</span> = <span class="title">myfun</span><span class="params">(x1,...,xM)</span></span></span><br><span class="line">    <span class="comment">% here scripts</span></span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure>
<p>To create a script, use the <code>edit</code> command,</p>
<figure class="highlight matlab"><table><tr><td class="code"><pre><span class="line">edit whateverScriptNameYouLike</span><br></pre></td></tr></table></figure>
<figure class="highlight matlab"><table><tr><td class="code"><pre><span class="line">N = <span class="number">100</span>;</span><br><span class="line">f(<span class="number">1</span>) = <span class="number">1</span>;</span><br><span class="line">f(<span class="number">2</span>) = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span> <span class="built_in">i</span> = <span class="number">3</span>:N   <span class="comment">% for loop</span></span><br><span class="line">    f(<span class="built_in">i</span>) = f(<span class="built_in">i</span> - <span class="number">1</span>) + f(<span class="built_in">i</span> - <span class="number">2</span>);</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line">f(<span class="number">1</span>:<span class="number">10</span>)</span><br><span class="line"></span><br><span class="line">&gt;&gt; <span class="keyword">for</span> <span class="built_in">i</span>=<span class="number">1</span>:<span class="number">-0.3</span>:<span class="number">0</span></span><br><span class="line"><span class="built_in">disp</span>(<span class="built_in">i</span>);</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line">     <span class="number">1</span></span><br><span class="line"></span><br><span class="line">    <span class="number">0.7000</span></span><br><span class="line"></span><br><span class="line">    <span class="number">0.4000</span></span><br><span class="line"></span><br><span class="line">    <span class="number">0.1000</span></span><br><span class="line"></span><br><span class="line"><span class="comment">% if elseif and else</span></span><br><span class="line">num=randi(<span class="number">100</span>)</span><br><span class="line"><span class="keyword">if</span> num&lt;<span class="number">34</span></span><br><span class="line">  sz=<span class="string">&#x27;low&#x27;</span></span><br><span class="line"><span class="keyword">elseif</span> num&lt;<span class="number">67</span></span><br><span class="line">  sz=<span class="string">&#x27;medium&#x27;</span></span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">  sz=<span class="string">&#x27;high&#x27;</span></span><br><span class="line"><span class="keyword">end</span> <span class="comment">% remember to add &#x27;end&#x27; at the end of if!!!!</span></span><br><span class="line"></span><br><span class="line">n = <span class="number">10</span>;</span><br><span class="line">f = n;</span><br><span class="line"><span class="keyword">while</span> n &gt; <span class="number">1</span>  <span class="comment">% while loop</span></span><br><span class="line">    n = n<span class="number">-1</span>;</span><br><span class="line">    f = f*n;</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"><span class="built_in">disp</span>([<span class="string">&#x27;n! = &#x27;</span> num2str(f)])</span><br></pre></td></tr></table></figure>
]]></content>
      <tags>
        <tag>Notes</tag>
        <tag>Matlab</tag>
      </tags>
  </entry>
  <entry>
    <title>VSCode Using Notes</title>
    <url>/2022/04/28/VSCode-Using-Notes/</url>
    <content><![CDATA[<h2 id="How-to-write-MATLAB-scripts-in-VSCode"><a href="#How-to-write-MATLAB-scripts-in-VSCode" class="headerlink" title="How to write MATLAB scripts in VSCode"></a>How to write MATLAB scripts in VSCode</h2><p>However, I find it not a good idea. The terminal crashes from time to time and <code>Workspace</code> in MATLAB cannot be intergrated into vscode.</p>
<p>The main reason I want to use vscode to write MATLAB scripts is darkmode and suggestions. By changing the color profile and enabling autocompletion in MATLAB preferences, I can get a similar result.</p>
<h3 id="Install-Extentions"><a href="#Install-Extentions" class="headerlink" title="Install Extentions"></a>Install Extentions</h3><figure class="highlight py"><table><tr><td class="code"><pre><span class="line">Matlab <span class="comment"># highlighting, suggestions, error messages</span></span><br><span class="line"><span class="comment"># You need to set matlab path and mlint path in the extention settings page.</span></span><br><span class="line"></span><br><span class="line">matlab-formatter <span class="comment"># format things</span></span><br><span class="line"><span class="comment"># You need to set Python path in the extention settings page. </span></span><br><span class="line"></span><br><span class="line">Matlab Interactive Terminal <span class="comment"># use vscode terminal instead of matlab IDE</span></span><br><span class="line"><span class="comment"># You need to set Python path in the extention settings page.</span></span><br><span class="line"><span class="comment"># If you enable this extention, do not enable another extention &#x27;matlab-code-run&#x27;</span></span><br><span class="line"></span><br><span class="line">Matlab Snippets <span class="comment"># more advanced suggestions </span></span><br></pre></td></tr></table></figure>
<h3 id="Install-MATLAB-API-for-Python"><a href="#Install-MATLAB-API-for-Python" class="headerlink" title="Install MATLAB API for Python"></a>Install MATLAB API for Python</h3><p>The extention <code>Matlab Interactive Terminal</code> is based on matlab api for python. Follow <a href="https://ww2.mathworks.cn/help/matlab/matlab_external/install-the-matlab-engine-for-python.html">this doc</a> to install matlab api for python.</p>
<p>In Windows, <code>cd matlabRootPath\extern\engines\python</code>, then <code>python setup.py install</code>.  </p>
]]></content>
      <tags>
        <tag>Notes</tag>
        <tag>Software Using</tag>
      </tags>
  </entry>
  <entry>
    <title>Vue Learning Notes</title>
    <url>/2022/04/27/Vue-Learning-Notes/</url>
    <content><![CDATA[<h2 id="Vue-Router-Related"><a href="#Vue-Router-Related" class="headerlink" title="Vue Router Related"></a>Vue Router Related</h2><h3 id="Navigation-Guard"><a href="#Navigation-Guard" class="headerlink" title="Navigation Guard"></a>Navigation Guard</h3><p>Docs: <a href="https://router.vuejs.org/guide/advanced/navigation-guards.html">Navigation Guards</a></p>
<p>As the name suggests, the navigation guards provided by Vue router are primarily used to guard navigations either by redirecting it or canceling it.</p>
<p>To put it in other words, navigation guards allows you to know the urls of the jump-out page and the jump-in page.</p>
<p>To get url of the jump-out page, in <code>whateverName.vue</code>, add:</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">default</span>&#123;</span><br><span class="line">    <span class="title function_">data</span>(<span class="params"></span>)&#123;</span><br><span class="line">        <span class="keyword">return</span>&#123;</span><br><span class="line">            <span class="attr">lastURL</span>:<span class="string">&#x27;&#x27;</span>,</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="title function_">beforeRouteEnter</span>(<span class="params">to, <span class="keyword">from</span>, next</span>) &#123;</span><br><span class="line">    <span class="title function_">next</span>(<span class="function">(<span class="params">vw</span>) =&gt;</span> &#123;</span><br><span class="line">      <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="keyword">from</span>)</span><br><span class="line">      vw.<span class="property">lastUrl</span> = <span class="keyword">from</span>.<span class="property">fullPath</span></span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="Back-to-previous-route"><a href="#Back-to-previous-route" class="headerlink" title="Back to previous route"></a>Back to previous route</h3><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="variable language_">this</span>.<span class="property">$router</span>.<span class="title function_">back</span>()</span><br></pre></td></tr></table></figure>
<h2 id="Vuex-Related"><a href="#Vuex-Related" class="headerlink" title="Vuex Related"></a>Vuex Related</h2><h3 id="Get-Variables"><a href="#Get-Variables" class="headerlink" title="Get Variables"></a>Get Variables</h3><p>In <code>/store/index.js</code>, add:</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">Vuex</span> <span class="keyword">from</span> <span class="string">&#x27;vuex&#x27;</span></span><br><span class="line"><span class="title class_">Vue</span>.<span class="title function_">use</span>(<span class="title class_">Vuex</span>)</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="keyword">new</span> <span class="title class_">Vuex</span>.<span class="title class_">Store</span>(&#123;</span><br><span class="line">    <span class="attr">state</span>: &#123;</span><br><span class="line">        <span class="attr">variableName</span>:<span class="string">&#x27;this is a global variable&#x27;</span>,</span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<p>In <code>view</code>:</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">default</span>&#123;</span><br><span class="line">    <span class="attr">computed</span>:&#123;</span><br><span class="line">        <span class="title function_">anyNameYourLike</span>(<span class="params"></span>)&#123;</span><br><span class="line">            reutnr <span class="variable language_">this</span>.<span class="property">$store</span>.<span class="property">state</span>.<span class="property">variableName</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
]]></content>
      <tags>
        <tag>Web Dev</tag>
        <tag>Notes</tag>
        <tag>Vue</tag>
        <tag>Frontend</tag>
      </tags>
  </entry>
  <entry>
    <title>Vue+Django CORS and CSRF</title>
    <url>/2022/04/27/Vue-Django-CORS-and-CSRF/</url>
    <content><![CDATA[<h2 id="Backend-Django-Part"><a href="#Backend-Django-Part" class="headerlink" title="Backend (Django) Part"></a>Backend (Django) Part</h2><p>Docs: <a href="https://pypi.org/project/django-cors-headers/">django-cors-headers</a>, <a href="https://docs.djangoproject.com/en/4.0/ref/settings/#csrf-cookie-secure">django core settings</a></p>
<p>According to <a href="https://pypi.org/project/django-cors-headers/">django-cors-headers</a>, use:</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">python -m pip install django-cors-headers</span><br></pre></td></tr></table></figure>
<p>to install <code>django-cors-headers</code> and add it to installed apps in <code>settings.py</code></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">INSTALLED_APPS = [</span><br><span class="line">    ...,</span><br><span class="line">    <span class="string">&quot;corsheaders&quot;</span>,</span><br><span class="line">    ...,</span><br><span class="line">]</span><br></pre></td></tr></table></figure>
<p>Add a middleware class to listen in on responses. The order of middlewares is <strong>important</strong>:</p>
<p><code>CorsMiddleware</code> should be placed as high as possible, especially before any middleware that can generate responses such as Django’s <code>CommonMiddleware</code> or Whitenoise’s <code>WhiteNoiseMiddleware</code>. If it is not before, it will not be able to add the CORS headers to these responses.</p>
<p>Also if you are using <code>CORS_REPLACE_HTTPS_REFERER</code> it should be placed before Django’s <code>CsrfViewMiddleware</code>.</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">MIDDLEWARE = [</span><br><span class="line">    ...,</span><br><span class="line">    <span class="string">&quot;corsheaders.middleware.CorsMiddleware&quot;</span>,</span><br><span class="line">    <span class="string">&quot;django.middleware.common.CommonMiddleware&quot;</span>,</span><br><span class="line">    ...,</span><br><span class="line">]</span><br></pre></td></tr></table></figure>
<p>Assume frontend is functioning on <code>frontend.com</code>.</p>
<p>Add:</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">CORS_ALLOWED_ORIGINS = [</span><br><span class="line">    <span class="string">&quot;frontend.com&quot;</span>,</span><br><span class="line">]</span><br><span class="line"></span><br><span class="line">CORS_ALLOW_METHODS = [</span><br><span class="line">    <span class="string">&quot;DELETE&quot;</span>,</span><br><span class="line">    <span class="string">&quot;GET&quot;</span>,</span><br><span class="line">    <span class="string">&quot;OPTIONS&quot;</span>,</span><br><span class="line">    <span class="string">&quot;PATCH&quot;</span>,</span><br><span class="line">    <span class="string">&quot;POST&quot;</span>,</span><br><span class="line">    <span class="string">&quot;PUT&quot;</span>,</span><br><span class="line">    <span class="comment">#enable whatever method needed</span></span><br><span class="line">]</span><br><span class="line"></span><br><span class="line">CSRF_TRUSTED_ORIGINS = [</span><br><span class="line">    <span class="string">&quot;frontend.com&quot;</span>,</span><br><span class="line">]</span><br><span class="line"></span><br><span class="line">CORS_ALLOW_CREDENTIALS = <span class="literal">True</span></span><br><span class="line"></span><br><span class="line">CSRF_COOKIE_SECURE = <span class="literal">True</span></span><br><span class="line"></span><br><span class="line">CSRF_COOKIE_SAMESITE = <span class="string">&#x27;None&#x27;</span></span><br></pre></td></tr></table></figure>
<h2 id="Frontend-Vue-Part"><a href="#Frontend-Vue-Part" class="headerlink" title="Frontend (Vue) Part"></a>Frontend (Vue) Part</h2><p>Docs: <a href="https://axios-http.com/docs/req_config">Axios Request Config</a></p>
<p>We need to get CSRF token contained in cookie from backend.</p>
<p>In <code>urls.py</code>:</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">get_csrf_token</span>(<span class="params">request</span>):</span><br><span class="line">    csrf_token = get_token(request)</span><br><span class="line">    <span class="keyword">return</span> JsonResponse(&#123;<span class="string">&#x27;token&#x27;</span>: csrf_token&#125;)</span><br><span class="line"></span><br><span class="line">urlpatterns=[</span><br><span class="line">    ...</span><br><span class="line">    path(<span class="string">&#x27;get_csrf_token/&#x27;</span>, get_csrf_token),</span><br><span class="line">    ...</span><br><span class="line">]</span><br></pre></td></tr></table></figure>
<p>Assume the backend is functioning on <code>backend.com</code>. In <code>whateverName.vue</code>, add:</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">//django use cookies to varify csrf</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">VueCookies</span> <span class="keyword">from</span> <span class="string">&#x27;vue-cookies&#x27;</span></span><br><span class="line"><span class="title class_">Vue</span>.<span class="title function_">use</span>(<span class="title class_">VueCookies</span>)</span><br><span class="line"><span class="comment">//`withCredentials` indicates whether or not cross-site Access-Control requests should be made using credentials</span></span><br><span class="line">axios.<span class="property">defaults</span>.<span class="property">withCredentials</span> = <span class="literal">true</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span>&#123;</span><br><span class="line">    <span class="title function_">data</span>(<span class="params"></span>)&#123;</span><br><span class="line">        <span class="keyword">return</span>&#123;</span><br><span class="line">            <span class="attr">token</span>:<span class="string">&#x27;&#x27;</span>,</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">methods</span>:&#123;</span><br><span class="line">        <span class="comment">//get token function</span></span><br><span class="line">        <span class="title function_">gettoken</span>(<span class="params"></span>) &#123;</span><br><span class="line">            <span class="title function_">axios</span>(&#123;</span><br><span class="line">                <span class="attr">method</span>: <span class="string">&#x27;get&#x27;</span>,</span><br><span class="line">                <span class="attr">url</span>: <span class="string">`http://backend.com/get_csrf_token/`</span>,</span><br><span class="line">                <span class="attr">withCredentials</span>: <span class="literal">true</span></span><br><span class="line">            &#125;)</span><br><span class="line">                .<span class="title function_">then</span>(<span class="function">(<span class="params">res</span>) =&gt;</span> &#123;</span><br><span class="line">                    <span class="variable language_">this</span>.<span class="property">token</span> = res.<span class="property">data</span>.<span class="property">token</span></span><br><span class="line">                &#125;)</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="comment">//POST</span></span><br><span class="line">        <span class="title function_">tryPOST</span>(<span class="params"></span>)&#123;</span><br><span class="line">            <span class="title function_">axios</span>(&#123;</span><br><span class="line">                <span class="attr">headers</span>: &#123;</span><br><span class="line">                    <span class="string">&#x27;X-CSRFToken&#x27;</span>: <span class="variable language_">this</span>.<span class="property">token</span>,</span><br><span class="line">                    <span class="string">&#x27;Content-Type&#x27;</span>: <span class="string">&#x27;application/json&#x27;</span>,</span><br><span class="line">                &#125;,</span><br><span class="line">                <span class="attr">withCredentials</span>: <span class="literal">true</span>,</span><br><span class="line">                <span class="attr">url</span>: <span class="string">`http://backend.com/whateverURL`</span>,</span><br><span class="line">                <span class="attr">method</span>: <span class="string">&#x27;post&#x27;</span>,</span><br><span class="line">                <span class="attr">data</span>: &#123;</span><br><span class="line">                    <span class="string">&#x27;data1&#x27;</span>: <span class="string">&#x27;data2&#x27;</span>,</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;)</span><br><span class="line">                .<span class="title function_">then</span>(<span class="function">(<span class="params">res</span>) =&gt;</span> &#123;</span><br><span class="line">                    <span class="variable language_">console</span>.<span class="title function_">log</span>(res)</span><br><span class="line">                &#125;)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">mounted</span>:<span class="function">()=&gt;</span>&#123;</span><br><span class="line">        <span class="comment">//get token when page loads</span></span><br><span class="line">        <span class="variable language_">this</span>.<span class="title function_">gettoken</span>()</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
]]></content>
      <tags>
        <tag>Web Dev</tag>
        <tag>Backend</tag>
        <tag>Django</tag>
        <tag>Tutorial</tag>
        <tag>Vue</tag>
        <tag>Frontend</tag>
      </tags>
  </entry>
</search>
